{"version":3,"sources":["App.js","index.js"],"names":["gui","dat","settings","numOfPoints","guiNumOfPoints","add","name","listen","INITIAL_VIEW_STATE","longitude","latitude","zoom","DATA_URLS","getPointUrls","number","point_urls","colorScale","chroma","scale","domain","sizeScale","scaleLinear","range","App","state","jsonData","mapStyle","length","BASEMAP","POSITRON","_loadPoints","_loadData","then","data","setState","a","promisedData","forEach","url","push","Promise","resolve","reject","load","JSONLoader","all","values","flat","onChange","value","this","destroy","layers","SimpleMeshLayer","id","mesh","loaders","OBJLoader","getScale","d","properties","vel_avg","getPosition","geometry","coordinates","getColor","rgb","getOrientation","az_ang","inc_ang","getTranslation","h_cop30m","initialViewState","controller","mapboxApiAccessToken","Component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"4bAaMA,EAAM,IAAIC,IACVC,EAAW,CACbC,YAAa,WAEbC,EAAiBJ,EAAIK,IAAIH,EAAU,cAAe,CAAC,UAAW,UAAW,cAAcI,KAAK,oBAAoBC,SAG9GC,EAAqB,CACvBC,UAAW,UACXC,SAAU,QACVC,KAAM,IAQJC,EACO,2FADPA,EAEQ,4FAFRA,EAGS,6FAHTA,EAIU,8FAJVA,EAKO,kBAGPC,EAAe,SAACC,GAClB,OAAQA,GACJ,IAAK,UACDC,EAAa,CAACH,GACd,MACJ,IAAK,UACDG,EAAa,CAACH,EAAiBA,GAC/B,MACJ,IAAK,YACDG,EAAa,CAACH,EAAiBA,EAAkBA,EAAmBA,GACpE,MACJ,QACIG,EAAa,CAACH,KAItBG,EAAa,GAEjBF,EAAaX,EAASC,aAEtB,IAAIa,EAAaC,IACZC,MAAM,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,YAC9DC,OAAO,EAAE,GAAI,KAEdC,EAAYC,cAAcF,OAAO,EAAE,GAAI,KAAKG,MAAM,CAAC,EAAG,IAGrCC,E,4MACjBC,MAAQ,CACJC,SAAU,GACVC,SAxCoB,GAwCUC,OAAS,EAAI,sCAAwCC,IAAQC,U,EAgB/FC,YAAc,WACV,EAAKC,YAAYC,MAAK,SAACC,GACnB,EAAKC,SAAS,CAACT,SAAUQ,Q,EAIjCF,U,sBAAY,4BAAAI,EAAA,6DACJC,EAAe,GACnBrB,EAAWsB,SAAQ,SAACC,GAAD,OACfF,EAAaG,KACT,IAAIC,SAAQ,SAACC,EAASC,GAAV,OAAqBD,EAAQE,YAAKL,EAAKM,aAJnD,kBAODJ,QAAQK,IAAIT,GAAcJ,MAAK,SAACc,GAAD,OAAYA,EAAOC,WAPjD,2C,uDAnBZ,WAAqB,IAAD,OAChB3C,EAAe4C,UAAS,SAAAC,GACpB,EAAKf,SAAS,CAACT,SAAU,KACzBZ,EAAaoC,GACb,EAAKnB,iBAEToB,KAAKpB,gB,kCAGT,WACI9B,EAAImD,Y,oBAmBR,WACI,IAAIC,EAAS,GAuBb,OArBIF,KAAK1B,MAAMC,SAASE,OAAS,GAC7ByB,EAAOb,KACH,IAAIc,IAAgB,CAChBC,GAAI,aACJrB,KAAMiB,KAAK1B,MAAMC,SACjB8B,KAAM3C,EACN4C,QAAS,CAACC,KACVC,SAAU,SAACC,GAAD,MAAO,CAAC,EAAGvC,EAAUuC,EAAEC,WAAWC,SAAU,IACtDzC,UAAW,IACX0C,YAAa,SAACH,GAAD,OAAOA,EAAEI,SAASC,aAC/BC,SAAU,SAACN,GAAD,OAAO3C,EAAW2C,EAAEC,WAAWC,SAASK,OAClDC,eAAgB,SAACR,GAAD,MAAO,CACnB,EACAA,EAAEC,WAAWQ,OACbT,EAAEC,WAAWS,UAEjBC,eAAgB,SAACX,GAAD,MAAO,CAAC,EAAG,EAA2B,IAAxBA,EAAEC,WAAWW,cAMnD,8BACI,cAAC,IAAD,CACIC,iBAAkBhE,EAClBiE,YAAY,EACZrB,OAAQA,EAHZ,SAKI,cAAC,IAAD,CACIsB,qBAxGI,GAyGJhD,SAAUwB,KAAK1B,MAAME,mB,GApEZiD,aC9DjCC,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.c33d98ac.chunk.js","sourcesContent":["import React, {Component} from \"react\";\r\nimport DeckGL from \"@deck.gl/react\";\r\nimport {StaticMap} from \"react-map-gl\";\r\nimport {JSONLoader} from \"@loaders.gl/json\";\r\nimport chroma from \"chroma-js\";\r\nimport {load} from \"@loaders.gl/core\";\r\nimport {SimpleMeshLayer} from \"@deck.gl/mesh-layers\";\r\nimport {OBJLoader} from \"@loaders.gl/obj\";\r\nimport {scaleLinear} from \"d3-scale\";\r\nimport * as dat from 'dat.gui'\r\nimport {BASEMAP} from '@deck.gl/carto';\r\n\r\n// ---- GUI definition - start\r\nconst gui = new dat.GUI();\r\nconst settings = {\r\n    numOfPoints: \"400 000\",\r\n}\r\nlet guiNumOfPoints = gui.add(settings, 'numOfPoints', ['400 000', '900 000', '1 700 000']).name('Number of arrows').listen();\r\n// ---- GUI definition - end\r\n\r\nconst INITIAL_VIEW_STATE = {\r\n    longitude: 120.81321,\r\n    latitude: 14.7569,\r\n    zoom: 10,\r\n};\r\n\r\n\r\n// if you want to use mapbox background layers fill in your mapbox token\r\n// when MAPBOX_ACCESS_TOKEN is empty, background layer from \"CARTO basemaps\" is used instead\r\nconst MAPBOX_ACCESS_TOKEN = \"\";\r\n\r\nconst DATA_URLS = {\r\n    \"los32\": \"https://ptr.gisat.cz/ftpstorage/applications/3dflus/test_data/interferometry/los/32.json\",\r\n    \"los142\": \"https://ptr.gisat.cz/ftpstorage/applications/3dflus/test_data/interferometry/los/142.json\",\r\n    \"vertg32\": \"https://ptr.gisat.cz/ftpstorage/applications/3dflus/test_data/interferometry/vertg/32.json\",\r\n    \"vertg142\": \"https://ptr.gisat.cz/ftpstorage/applications/3dflus/test_data/interferometry/vertg/142.json\",\r\n    \"arrow\": \"./obj/arrow.obj\"\r\n}\r\n\r\nconst getPointUrls = (number) => {\r\n    switch (number) {\r\n        case \"400 000\":\r\n            point_urls = [DATA_URLS.los142]\r\n            break;\r\n        case \"900 000\":\r\n            point_urls = [DATA_URLS.los32, DATA_URLS.los142]\r\n            break;\r\n        case \"1 700 000\":\r\n            point_urls = [DATA_URLS.los32, DATA_URLS.los142, DATA_URLS.vertg32, DATA_URLS.vertg142]\r\n            break;\r\n        default:\r\n            point_urls = [DATA_URLS.los142]\r\n    }\r\n}\r\n\r\nlet point_urls = [];\r\n\r\ngetPointUrls(settings.numOfPoints)\r\n\r\nlet colorScale = chroma\r\n    .scale([\"#fda34b\", \"#ff7882\", \"#c8699e\", \"#7046aa\", \"#0c1db8\", \"#2eaaac\"])\r\n    .domain([-30, 10]);\r\n\r\nlet sizeScale = scaleLinear().domain([-30, 10]).range([4, 1]);\r\n\r\n\r\nexport default class App extends Component {\r\n    state = {\r\n        jsonData: [],\r\n        mapStyle: MAPBOX_ACCESS_TOKEN.length > 0 ? 'mapbox://styles/mapbox/satellite-v9' : BASEMAP.POSITRON,\r\n    };\r\n\r\n    componentDidMount() {\r\n        guiNumOfPoints.onChange(value => {\r\n            this.setState({jsonData: []});\r\n            getPointUrls(value)\r\n            this._loadPoints()\r\n        })\r\n        this._loadPoints()\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        gui.destroy()\r\n    }\r\n\r\n    _loadPoints = () => {\r\n        this._loadData().then((data) => {\r\n            this.setState({jsonData: data});\r\n        });\r\n    }\r\n\r\n    _loadData = async () => {\r\n        let promisedData = [];\r\n        point_urls.forEach((url) =>\r\n            promisedData.push(\r\n                new Promise((resolve, reject) => resolve(load(url, JSONLoader)))\r\n            )\r\n        );\r\n        return Promise.all(promisedData).then((values) => values.flat());\r\n    };\r\n\r\n    render() {\r\n        let layers = [];\r\n\r\n        if (this.state.jsonData.length > 0) {\r\n            layers.push(\r\n                new SimpleMeshLayer({\r\n                    id: \"mesh-layer\",\r\n                    data: this.state.jsonData,\r\n                    mesh: DATA_URLS.arrow,\r\n                    loaders: [OBJLoader],\r\n                    getScale: (d) => [1, sizeScale(d.properties.vel_avg), 1],\r\n                    sizeScale: 100,\r\n                    getPosition: (d) => d.geometry.coordinates,\r\n                    getColor: (d) => colorScale(d.properties.vel_avg).rgb(),\r\n                    getOrientation: (d) => [\r\n                        0,\r\n                        d.properties.az_ang,\r\n                        d.properties.inc_ang,\r\n                    ],\r\n                    getTranslation: (d) => [0, 0, d.properties.h_cop30m * 100],\r\n                })\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <DeckGL\r\n                    initialViewState={INITIAL_VIEW_STATE}\r\n                    controller={true}\r\n                    layers={layers}\r\n                >\r\n                    <StaticMap\r\n                        mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\r\n                        mapStyle={this.state.mapStyle}/>\r\n                </DeckGL>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}